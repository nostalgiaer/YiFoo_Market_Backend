"use strict";(self["webpackChunkbuaa_market"]=self["webpackChunkbuaa_market"]||[]).push([[99],{6099:function(t,e,o){o.r(e),o.d(e,{default:function(){return w}});var s=o(6190),l=o(4886),a=o(2118),d=o(4324),i=o(1713),r=function(){var t=this,e=t._self._c;return e(a.Z,{attrs:{fluid:""}},[0===t.carts?.length?e(i.Z,{staticStyle:{"min-height":"300px"},attrs:{justify:"center",align:"center"}},[e(l.EB,{staticClass:"no-comment"},[t._v(" 当前购物车暂无物品 ")])],1):t._e(),t._l(t.carts,(function(o){return[e("cart-panel-item",{key:o.postId,staticStyle:{margin:"0% 5% 3% 0%"},attrs:{selectedGoods:t.selectedGoods,cart:o},on:{reload:t.loadCart}})]})),e("div",[e(s.Z,{staticClass:"my-2 buy-btn",attrs:{color:"indigo",fab:"",dark:"",large:""},on:{click:t.buyGood}},[e(d.Z,[t._v("mdi-cart")])],1)],1),e("div",[e(s.Z,{staticClass:"my-2 delete-btn",attrs:{color:"error",fab:"",dark:"",large:""},on:{click:t.deleteGood}},[e(d.Z,[t._v("mdi-delete")])],1)],1)],2)},c=[],n=o(8472);async function h(t,e){const o="/api/cart";return(0,n.W)(o,t,e)}var u=o(9582),f=o(120),p=function(){var t=this,e=t._self._c;return e(u.Z,{attrs:{outlined:""}},[e(l.EB,[e("div",{staticClass:"shrink",on:{click:function(t){t.stopPropagation()}}},[e(f.Z,{key:t.cart.postId,staticClass:"shrink",on:{click:t.changeAllCheck},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}})],1),e(d.Z,{staticClass:"shrink",staticStyle:{"padding-right":"5px"},attrs:{color:"primary"}},[t._v(" mdi-store ")]),e("ul",{staticClass:"text-h5 shrink",attrs:{color:"grey darken-3"},on:{click:function(e){return t.jumpToPost()}}},[t._v("帖子: "+t._s(t.cart.postTitle))])],1),t._l(t.cart.goods,(function(o){return e(l.ZB,{key:o.commodityId},[e(a.Z,{attrs:{fluid:""}},[e(i.Z,[e(f.Z,{key:t.cart.postId+"___"+o.trolleyId,staticClass:"shrink",staticStyle:{display:"inline-block","margin-right":"5%"},attrs:{value:o.trolleyId},on:{change:t.checkGood},model:{value:t.selfGoods,callback:function(e){t.selfGoods=e},expression:"selfGoods"}}),e("cart-good-item",{staticStyle:{display:"inline-block"},attrs:{cart:t.cart,good:o,selfGoods:t.selfGoods},on:{reload:function(e){return t.$emit("reload")}}})],1)],1)],1)}))],2)},g=[],y=o(3423),m=o(266),k=o(5495),G=o(9780),b=function(){var t=this,e=t._self._c;return e(u.Z,{staticStyle:{width:"75%",padding:"1% 0%","margin-right":"0%"},attrs:{color:-1===t.selfGoods.indexOf(t.good.trolleyId)?"blue-grey lighten-5":"light-blue lighten-2"}},[e(i.Z,[e(m.Z,{attrs:{sm:"3",md:"2",lg:"2"}},[e(y.Z,{staticStyle:{"margin-left":"10%"},attrs:{color:"grey",size:"100",tile:""}},[e(k.Z,{attrs:{src:t.good.img}})],1)],1),e(m.Z,{attrs:{sm:"9",md:"10",lg:"10"}},[e(l.EB,{staticStyle:{"padding-top":"0% !important"}},[t._v(" 商品:   "+t._s(t.good.name)+" ")]),e(l.ZB,[e("p",{staticClass:"text-h6",staticStyle:{display:"inline-block","margin-top":"1%"}},[t._v(" ￥ "+t._s(t.good.price)+" ")]),t.editable?t._e():e(s.Z,{staticStyle:{float:"right"},attrs:{text:"",outlined:"",top:""},on:{click:t.changeEdit}},[e("ul",{staticStyle:{"padding-top":"17px"}},[t._v(" x"),e("p",{staticClass:"text-h6",staticStyle:{display:"inline-block"}},[t._v(" "+t._s(t.good.num)+" ")])])]),t.editable?e(G.Z,{ref:"input",staticStyle:{float:"right"},attrs:{outlined:"",label:"test"},on:{blur:function(e){return t.changeNum()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeNum()}},model:{value:t.good.num,callback:function(e){t.$set(t.good,"num",e)},expression:"good.num"}}):t._e()],1)],1)],1)],1)},_=[],I=o(4094),C={name:"CartGoodItem",props:{cart:{type:Object,default:{},required:!0},good:{type:Object,default:{},required:!0},selfGoods:{type:Array,default:[],required:!0}},data:()=>({editable:!1}),methods:{changeNum(){const t=this;this.editable=!1,h("put",{trolleyId:this.good.trolleyId,num:this.good.num}).then((e=>{e.success||(0,I.D4)(e),t.$emit("reload")})).catch((e=>{console.log(e),t.$emit("reload")}))},changeEdit(){this.editable=!0,this.$nextTick((()=>{this.$refs.input.focus()}))}}},x=C,Z=o(1001),v=(0,Z.Z)(x,b,_,!1,null,null,null),S=v.exports,O={name:"CartPanelItem",components:{CartGoodItem:S},props:{cart:{type:Object,default:{},required:!0},selectedGoods:{type:Array,default:[],required:!0}},data:()=>({checkAll:!1,selfGoods:[],editable:{}}),methods:{checkGood(){let t=!0;this.cart.goods.forEach((e=>{if(-1===this.selfGoods.indexOf(e.trolleyId)){t=!1;let o=this.selectedGoods.indexOf(e.trolleyId);-1!==o&&this.selectedGoods.splice(o,1)}})),this.checkAll=t,t=!1,this.selfGoods.forEach((t=>{-1===this.selectedGoods.indexOf(t)&&this.selectedGoods.push(t)}))},changeAllCheck(){1==this.checkAll?this.cart.goods.forEach((t=>{let e=this.selectedGoods.indexOf(t.trolleyId);-1===e&&this.selectedGoods.push(t.trolleyId),-1===this.selfGoods.indexOf(t.trolleyId)&&this.selfGoods.push(t.trolleyId)})):this.cart.goods.forEach((t=>{let e=this.selectedGoods.indexOf(t.trolleyId);-1!==e&&this.selectedGoods.splice(e,1),e=this.selfGoods.indexOf(t.trolleyId),-1!==this.selfGoods.indexOf(t.trolleyId)&&this.selfGoods.splice(e,1)}))},jumpToPost(){this.$router.push({path:`/ground/sell/${this.cart.postId}`})}},watch:{}},E=O,A=(0,Z.Z)(E,p,g,!1,null,null,null),$=A.exports,D={name:"MyCartView",components:{CartPanelItem:$},data:()=>({carts:[],selectedGoods:[]}),methods:{loadCart(){const t=this;h("get",{}).then((e=>{e.data.success?t.carts=e.data.data.carts:(0,I.D4)(e)})).catch((t=>{(0,I.MI)()}))},allGoodSelected(t){let e=!0;return t.goods.forEach((t=>{this.selectedGoods[t.trolleyId]||(e=!1)})),e},buyGood(){const t=this;h("post",{goods:this.postData}).then((t=>{t.data.success?this.$router.go(0):(0,I.D4)(t)})).catch((e=>{console.log(e),t.loadCart()}))},deleteGood(){const t=this;h("delete",this.postData).then((e=>{e.data.success||(0,I.D4)(e),t.loadCart()})).catch((e=>{(0,I.MI)(),t.loadCart()}))}},computed:{postData(){let t=[];return this.selectedGoods.forEach((e=>{t.push({trolleyId:e})})),t}},mounted(){this.loadCart()}},j=D,q=(0,Z.Z)(j,r,c,!1,null,"54f24f6b",null),w=q.exports}}]);
//# sourceMappingURL=99.d34f314b.js.map